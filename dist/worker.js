var li=Object.create;var wt=Object.defineProperty;var di=Object.getOwnPropertyDescriptor;var xi=Object.getOwnPropertyNames;var pi=Object.getPrototypeOf,hi=Object.prototype.hasOwnProperty;var ir=(a=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(a,{get:(n,s)=>(typeof require<"u"?require:n)[s]}):a)(function(a){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+a+'" is not supported')});var Fe=(a,n)=>()=>(a&&(n=a(a=0)),n);var Tt=(a,n)=>()=>(n||a((n={exports:{}}).exports,n),n.exports),ar=(a,n)=>{for(var s in n)wt(a,s,{get:n[s],enumerable:!0})},or=(a,n,s,c)=>{if(n&&typeof n=="object"||typeof n=="function")for(let u of xi(n))!hi.call(a,u)&&u!==s&&wt(a,u,{get:()=>n[u],enumerable:!(c=di(n,u))||c.enumerable});return a};var Dt=(a,n,s)=>(s=a!=null?li(pi(a)):{},or(n||!a||!a.__esModule?wt(s,"default",{value:a,enumerable:!0}):s,a)),bi=a=>or(wt({},"__esModule",{value:!0}),a);var ee=Fe(()=>{});var te=Fe(()=>{});var fe={};ar(fe,{_debugEnd:()=>Xr,_debugProcess:()=>Jr,_events:()=>dn,_eventsCount:()=>xn,_exiting:()=>Ur,_fatalExceptions:()=>$r,_getActiveHandles:()=>Cr,_getActiveRequests:()=>Dr,_kill:()=>Mr,_linkedBinding:()=>Sr,_maxListeners:()=>ln,_preload_modules:()=>cn,_rawDebug:()=>Ir,_startProfilerIdleNotifier:()=>qr,_stopProfilerIdleNotifier:()=>Zr,_tickCallback:()=>Vr,abort:()=>tn,addListener:()=>pn,allowedNodeEnvironmentFlags:()=>Wr,arch:()=>lr,argv:()=>pr,argv0:()=>sn,assert:()=>Hr,binding:()=>Er,browser:()=>_r,chdir:()=>Tr,config:()=>Or,cpuUsage:()=>It,cwd:()=>wr,debugPort:()=>on,default:()=>An,dlopen:()=>Nr,domain:()=>Br,emit:()=>En,emitWarning:()=>gr,env:()=>xr,execArgv:()=>hr,execPath:()=>an,exit:()=>Pr,features:()=>Gr,hasUncaughtExceptionCaptureCallback:()=>Yr,hrtime:()=>_t,kill:()=>Fr,listeners:()=>Tn,memoryUsage:()=>vr,moduleLoadList:()=>Rr,nextTick:()=>cr,off:()=>bn,on:()=>Le,once:()=>hn,openStdin:()=>zr,pid:()=>rn,platform:()=>dr,ppid:()=>nn,prependListener:()=>yn,prependOnceListener:()=>wn,reallyExit:()=>Lr,release:()=>Ar,removeAllListeners:()=>gn,removeListener:()=>mn,resourceUsage:()=>kr,setSourceMapsEnabled:()=>un,setUncaughtExceptionCaptureCallback:()=>jr,stderr:()=>Kr,stdin:()=>en,stdout:()=>Qr,title:()=>fr,umask:()=>yr,uptime:()=>fn,version:()=>br,versions:()=>mr});function Mt(a){throw new Error("Node.js process "+a+" is not supported by JSPM core outside of Node.js")}function mi(){!et||!je||(et=!1,je.length?Ce=je.concat(Ce):At=-1,Ce.length&&sr())}function sr(){if(!et){var a=setTimeout(mi,0);et=!0;for(var n=Ce.length;n;){for(je=Ce,Ce=[];++At<n;)je&&je[At].run();At=-1,n=Ce.length}je=null,et=!1,clearTimeout(a)}}function cr(a){var n=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)n[s-1]=arguments[s];Ce.push(new ur(a,n)),Ce.length===1&&!et&&setTimeout(sr,0)}function ur(a,n){this.fun=a,this.array=n}function ue(){}function Sr(a){Mt("_linkedBinding")}function Nr(a){Mt("dlopen")}function Dr(){return[]}function Cr(){return[]}function Hr(a,n){if(!a)throw new Error(n||"assertion error")}function Yr(){return!1}function fn(){return Pe.now()/1e3}function _t(a){var n=Math.floor((Date.now()-Pe.now())*.001),s=Pe.now()*.001,c=Math.floor(s)+n,u=Math.floor(s%1*1e9);return a&&(c=c-a[0],u=u-a[1],u<0&&(c--,u+=Lt)),[c,u]}function Le(){return An}function Tn(a){return[]}var Ce,et,je,At,fr,lr,dr,xr,pr,hr,br,mr,gr,Er,yr,wr,Tr,Ar,_r,Ir,Rr,Br,Ur,Or,Lr,Mr,It,kr,vr,Fr,Pr,zr,Wr,Gr,$r,jr,Vr,Jr,Xr,qr,Zr,Qr,Kr,en,tn,rn,nn,an,on,sn,cn,un,Pe,Ct,Lt,ln,dn,xn,pn,hn,bn,mn,gn,En,yn,wn,An,_n=Fe(()=>{ee();te();ne();re();Ce=[],et=!1,At=-1;ur.prototype.run=function(){this.fun.apply(null,this.array)};fr="browser",lr="x64",dr="browser",xr={PATH:"/usr/bin",LANG:typeof navigator<"u"?navigator.language+".UTF-8":void 0,PWD:"/",HOME:"/home",TMP:"/tmp"},pr=["/usr/bin/node"],hr=[],br="v16.8.0",mr={},gr=function(a,n){console.warn((n?n+": ":"")+a)},Er=function(a){Mt("binding")},yr=function(a){return 0},wr=function(){return"/"},Tr=function(a){},Ar={name:"node",sourceUrl:"",headersUrl:"",libUrl:""};_r=!0,Ir=ue,Rr=[];Br={},Ur=!1,Or={};Lr=ue,Mr=ue,It=function(){return{}},kr=It,vr=It,Fr=ue,Pr=ue,zr=ue,Wr={};Gr={inspector:!1,debug:!1,uv:!1,ipv6:!1,tls_alpn:!1,tls_sni:!1,tls_ocsp:!1,tls:!1,cached_builtins:!0},$r=ue,jr=ue;Vr=ue,Jr=ue,Xr=ue,qr=ue,Zr=ue,Qr=void 0,Kr=void 0,en=void 0,tn=ue,rn=2,nn=1,an="/bin/usr/node",on=9229,sn="node",cn=[],un=ue,Pe={now:typeof performance<"u"?performance.now.bind(performance):void 0,timing:typeof performance<"u"?performance.timing:void 0};Pe.now===void 0&&(Ct=Date.now(),Pe.timing&&Pe.timing.navigationStart&&(Ct=Pe.timing.navigationStart),Pe.now=()=>Date.now()-Ct);Lt=1e9;_t.bigint=function(a){var n=_t(a);return typeof BigInt>"u"?n[0]*Lt+n[1]:BigInt(n[0]*Lt)+BigInt(n[1])};ln=10,dn={},xn=0;pn=Le,hn=Le,bn=Le,mn=Le,gn=Le,En=ue,yn=Le,wn=Le;An={version:br,versions:mr,arch:lr,platform:dr,browser:_r,release:Ar,_rawDebug:Ir,moduleLoadList:Rr,binding:Er,_linkedBinding:Sr,_events:dn,_eventsCount:xn,_maxListeners:ln,on:Le,addListener:pn,once:hn,off:bn,removeListener:mn,removeAllListeners:gn,emit:En,prependListener:yn,prependOnceListener:wn,listeners:Tn,domain:Br,_exiting:Ur,config:Or,dlopen:Nr,uptime:fn,_getActiveRequests:Dr,_getActiveHandles:Cr,reallyExit:Lr,_kill:Mr,cpuUsage:It,resourceUsage:kr,memoryUsage:vr,kill:Fr,exit:Pr,openStdin:zr,allowedNodeEnvironmentFlags:Wr,assert:Hr,features:Gr,_fatalExceptions:$r,setUncaughtExceptionCaptureCallback:jr,hasUncaughtExceptionCaptureCallback:Yr,emitWarning:gr,nextTick:cr,_tickCallback:Vr,_debugProcess:Jr,_debugEnd:Xr,_startProfilerIdleNotifier:qr,_stopProfilerIdleNotifier:Zr,stdout:Qr,stdin:en,stderr:Kr,abort:tn,umask:yr,chdir:Tr,cwd:wr,env:xr,title:fr,argv:pr,execArgv:hr,pid:rn,ppid:nn,execPath:an,debugPort:on,hrtime:_t,argv0:sn,_preload_modules:cn,setSourceMapsEnabled:un}});var re=Fe(()=>{_n()});function gi(){if(In)return ft;In=!0,ft.byteLength=T,ft.toByteArray=S,ft.fromByteArray=$;for(var a=[],n=[],s=typeof Uint8Array<"u"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,d=c.length;u<d;++u)a[u]=c[u],n[c.charCodeAt(u)]=u;n[45]=62,n[95]=63;function o(R){var U=R.length;if(U%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=R.indexOf("=");k===-1&&(k=U);var q=k===U?0:4-k%4;return[k,q]}function T(R){var U=o(R),k=U[0],q=U[1];return(k+q)*3/4-q}function _(R,U,k){return(U+k)*3/4-k}function S(R){var U,k=o(R),q=k[0],ie=k[1],J=new s(_(R,q,ie)),G=0,H=ie>0?q-4:q,X;for(X=0;X<H;X+=4)U=n[R.charCodeAt(X)]<<18|n[R.charCodeAt(X+1)]<<12|n[R.charCodeAt(X+2)]<<6|n[R.charCodeAt(X+3)],J[G++]=U>>16&255,J[G++]=U>>8&255,J[G++]=U&255;return ie===2&&(U=n[R.charCodeAt(X)]<<2|n[R.charCodeAt(X+1)]>>4,J[G++]=U&255),ie===1&&(U=n[R.charCodeAt(X)]<<10|n[R.charCodeAt(X+1)]<<4|n[R.charCodeAt(X+2)]>>2,J[G++]=U>>8&255,J[G++]=U&255),J}function B(R){return a[R>>18&63]+a[R>>12&63]+a[R>>6&63]+a[R&63]}function M(R,U,k){for(var q,ie=[],J=U;J<k;J+=3)q=(R[J]<<16&16711680)+(R[J+1]<<8&65280)+(R[J+2]&255),ie.push(B(q));return ie.join("")}function $(R){for(var U,k=R.length,q=k%3,ie=[],J=16383,G=0,H=k-q;G<H;G+=J)ie.push(M(R,G,G+J>H?H:G+J));return q===1?(U=R[k-1],ie.push(a[U>>2]+a[U<<4&63]+"==")):q===2&&(U=(R[k-2]<<8)+R[k-1],ie.push(a[U>>10]+a[U>>4&63]+a[U<<2&63]+"=")),ie.join("")}return ft}function Ei(){if(Rn)return Rt;Rn=!0;return Rt.read=function(a,n,s,c,u){var d,o,T=u*8-c-1,_=(1<<T)-1,S=_>>1,B=-7,M=s?u-1:0,$=s?-1:1,R=a[n+M];for(M+=$,d=R&(1<<-B)-1,R>>=-B,B+=T;B>0;d=d*256+a[n+M],M+=$,B-=8);for(o=d&(1<<-B)-1,d>>=-B,B+=c;B>0;o=o*256+a[n+M],M+=$,B-=8);if(d===0)d=1-S;else{if(d===_)return o?NaN:(R?-1:1)*(1/0);o=o+Math.pow(2,c),d=d-S}return(R?-1:1)*o*Math.pow(2,d-c)},Rt.write=function(a,n,s,c,u,d){var o,T,_,S=d*8-u-1,B=(1<<S)-1,M=B>>1,$=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=c?0:d-1,U=c?1:-1,k=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(T=isNaN(n)?1:0,o=B):(o=Math.floor(Math.log(n)/Math.LN2),n*(_=Math.pow(2,-o))<1&&(o--,_*=2),o+M>=1?n+=$/_:n+=$*Math.pow(2,1-M),n*_>=2&&(o++,_/=2),o+M>=B?(T=0,o=B):o+M>=1?(T=(n*_-1)*Math.pow(2,u),o=o+M):(T=n*Math.pow(2,M-1)*Math.pow(2,u),o=0));u>=8;a[s+R]=T&255,R+=U,T/=256,u-=8);for(o=o<<u|T,S+=u;S>0;a[s+R]=o&255,R+=U,o/=256,S-=8);a[s+R-U]|=k*128},Rt}function Bn(){if(Sn)return Ye;Sn=!0;let a=gi(),n=Ei(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Ye.Buffer=o,Ye.SlowBuffer=ie,Ye.INSPECT_MAX_BYTES=50;let c=2147483647;Ye.kMaxLength=c,o.TYPED_ARRAY_SUPPORT=u(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function u(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function d(r){if(r>c)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,o.prototype),e}function o(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return B(r)}return T(r,e,t)}o.poolSize=8192;function T(r,e,t){if(typeof r=="string")return M(r,e);if(ArrayBuffer.isView(r))return R(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(Ee(r,ArrayBuffer)||r&&Ee(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ee(r,SharedArrayBuffer)||r&&Ee(r.buffer,SharedArrayBuffer)))return U(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return o.from(i,e,t);let l=k(r);if(l)return l;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return o.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}o.from=function(r,e,t){return T(r,e,t)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function _(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function S(r,e,t){return _(r),r<=0?d(r):e!==void 0?typeof t=="string"?d(r).fill(e,t):d(r).fill(e):d(r)}o.alloc=function(r,e,t){return S(r,e,t)};function B(r){return _(r),d(r<0?0:q(r)|0)}o.allocUnsafe=function(r){return B(r)},o.allocUnsafeSlow=function(r){return B(r)};function M(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!o.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=J(r,e)|0,i=d(t),l=i.write(r,e);return l!==t&&(i=i.slice(0,l)),i}function $(r){let e=r.length<0?0:q(r.length)|0,t=d(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function R(r){if(Ee(r,Uint8Array)){let e=new Uint8Array(r);return U(e.buffer,e.byteOffset,e.byteLength)}return $(r)}function U(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,o.prototype),i}function k(r){if(o.isBuffer(r)){let e=q(r.length)|0,t=d(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||ot(r.length)?d(0):$(r);if(r.type==="Buffer"&&Array.isArray(r.data))return $(r.data)}function q(r){if(r>=c)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c.toString(16)+" bytes");return r|0}function ie(r){return+r!=r&&(r=0),o.alloc(+r)}o.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==o.prototype},o.compare=function(e,t){if(Ee(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),Ee(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,l=t.length;for(let b=0,g=Math.min(i,l);b<g;++b)if(e[b]!==t[b]){i=e[b],l=t[b];break}return i<l?-1:l<i?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return o.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let l=o.allocUnsafe(t),b=0;for(i=0;i<e.length;++i){let g=e[i];if(Ee(g,Uint8Array))b+g.length>l.length?(o.isBuffer(g)||(g=o.from(g)),g.copy(l,b)):Uint8Array.prototype.set.call(l,g,b);else if(o.isBuffer(g))g.copy(l,b);else throw new TypeError('"list" argument must be an Array of Buffers');b+=g.length}return l};function J(r,e){if(o.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||Ee(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let l=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return He(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Ge(r).length;default:if(l)return i?-1:He(r).length;e=(""+e).toLowerCase(),l=!0}}o.byteLength=J;function G(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return N(this,e,t);case"utf8":case"utf-8":return p(this,e,t);case"ascii":return I(this,e,t);case"latin1":case"binary":return P(this,e,t);case"base64":return h(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}o.prototype._isBuffer=!0;function H(r,e,t){let i=r[e];r[e]=r[t],r[t]=i}o.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)H(this,t,t+1);return this},o.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)H(this,t,t+3),H(this,t+1,t+2);return this},o.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)H(this,t,t+7),H(this,t+1,t+6),H(this,t+2,t+5),H(this,t+3,t+4);return this},o.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?p(this,0,e):G.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:o.compare(this,e)===0},o.prototype.inspect=function(){let e="",t=Ye.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},s&&(o.prototype[s]=o.prototype.inspect),o.prototype.compare=function(e,t,i,l,b){if(Ee(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),l===void 0&&(l=0),b===void 0&&(b=this.length),t<0||i>e.length||l<0||b>this.length)throw new RangeError("out of range index");if(l>=b&&t>=i)return 0;if(l>=b)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,l>>>=0,b>>>=0,this===e)return 0;let g=b-l,F=i-t,j=Math.min(g,F),Y=this.slice(l,b),Q=e.slice(t,i);for(let V=0;V<j;++V)if(Y[V]!==Q[V]){g=Y[V],F=Q[V];break}return g<F?-1:F<g?1:0};function X(r,e,t,i,l){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,ot(t)&&(t=l?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(l)return-1;t=r.length-1}else if(t<0)if(l)t=0;else return-1;if(typeof e=="string"&&(e=o.from(e,i)),o.isBuffer(e))return e.length===0?-1:Ue(r,e,t,i,l);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?l?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Ue(r,[e],t,i,l);throw new TypeError("val must be string, number or Buffer")}function Ue(r,e,t,i,l){let b=1,g=r.length,F=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;b=2,g/=2,F/=2,t/=2}function j(Q,V){return b===1?Q[V]:Q.readUInt16BE(V*b)}let Y;if(l){let Q=-1;for(Y=t;Y<g;Y++)if(j(r,Y)===j(e,Q===-1?0:Y-Q)){if(Q===-1&&(Q=Y),Y-Q+1===F)return Q*b}else Q!==-1&&(Y-=Y-Q),Q=-1}else for(t+F>g&&(t=g-F),Y=t;Y>=0;Y--){let Q=!0;for(let V=0;V<F;V++)if(j(r,Y+V)!==j(e,V)){Q=!1;break}if(Q)return Y}return-1}o.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1},o.prototype.indexOf=function(e,t,i){return X(this,e,t,i,!0)},o.prototype.lastIndexOf=function(e,t,i){return X(this,e,t,i,!1)};function nt(r,e,t,i){t=Number(t)||0;let l=r.length-t;i?(i=Number(i),i>l&&(i=l)):i=l;let b=e.length;i>b/2&&(i=b/2);let g;for(g=0;g<i;++g){let F=parseInt(e.substr(g*2,2),16);if(ot(F))return g;r[t+g]=F}return g}function Xe(r,e,t,i){return $e(He(e,r.length-t),r,t,i)}function We(r,e,t,i){return $e(ke(e),r,t,i)}function E(r,e,t,i){return $e(Ge(e),r,t,i)}function m(r,e,t,i){return $e(Qe(e,r.length-t),r,t,i)}o.prototype.write=function(e,t,i,l){if(t===void 0)l="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")l=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,l===void 0&&(l="utf8")):(l=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let b=this.length-t;if((i===void 0||i>b)&&(i=b),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");l||(l="utf8");let g=!1;for(;;)switch(l){case"hex":return nt(this,e,t,i);case"utf8":case"utf-8":return Xe(this,e,t,i);case"ascii":case"latin1":case"binary":return We(this,e,t,i);case"base64":return E(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m(this,e,t,i);default:if(g)throw new TypeError("Unknown encoding: "+l);l=(""+l).toLowerCase(),g=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function h(r,e,t){return e===0&&t===r.length?a.fromByteArray(r):a.fromByteArray(r.slice(e,t))}function p(r,e,t){t=Math.min(r.length,t);let i=[],l=e;for(;l<t;){let b=r[l],g=null,F=b>239?4:b>223?3:b>191?2:1;if(l+F<=t){let j,Y,Q,V;switch(F){case 1:b<128&&(g=b);break;case 2:j=r[l+1],(j&192)===128&&(V=(b&31)<<6|j&63,V>127&&(g=V));break;case 3:j=r[l+1],Y=r[l+2],(j&192)===128&&(Y&192)===128&&(V=(b&15)<<12|(j&63)<<6|Y&63,V>2047&&(V<55296||V>57343)&&(g=V));break;case 4:j=r[l+1],Y=r[l+2],Q=r[l+3],(j&192)===128&&(Y&192)===128&&(Q&192)===128&&(V=(b&15)<<18|(j&63)<<12|(Y&63)<<6|Q&63,V>65535&&V<1114112&&(g=V))}}g===null?(g=65533,F=1):g>65535&&(g-=65536,i.push(g>>>10&1023|55296),g=56320|g&1023),i.push(g),l+=F}return y(i)}let x=4096;function y(r){let e=r.length;if(e<=x)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=x));return t}function I(r,e,t){let i="";t=Math.min(r.length,t);for(let l=e;l<t;++l)i+=String.fromCharCode(r[l]&127);return i}function P(r,e,t){let i="";t=Math.min(r.length,t);for(let l=e;l<t;++l)i+=String.fromCharCode(r[l]);return i}function N(r,e,t){let i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let l="";for(let b=e;b<t;++b)l+=st[r[b]];return l}function z(r,e,t){let i=r.slice(e,t),l="";for(let b=0;b<i.length-1;b+=2)l+=String.fromCharCode(i[b]+i[b+1]*256);return l}o.prototype.slice=function(e,t){let i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);let l=this.subarray(e,t);return Object.setPrototypeOf(l,o.prototype),l};function L(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||L(e,t,this.length);let l=this[e],b=1,g=0;for(;++g<t&&(b*=256);)l+=this[e+g]*b;return l},o.prototype.readUintBE=o.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||L(e,t,this.length);let l=this[e+--t],b=1;for(;t>0&&(b*=256);)l+=this[e+--t]*b;return l},o.prototype.readUint8=o.prototype.readUInt8=function(e,t){return e=e>>>0,t||L(e,1,this.length),this[e]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||L(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||L(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||L(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readBigUInt64LE=he(function(e){e=e>>>0,ge(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Oe(e,this.length-8);let l=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,b=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(l)+(BigInt(b)<<BigInt(32))}),o.prototype.readBigUInt64BE=he(function(e){e=e>>>0,ge(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Oe(e,this.length-8);let l=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],b=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(l)<<BigInt(32))+BigInt(b)}),o.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||L(e,t,this.length);let l=this[e],b=1,g=0;for(;++g<t&&(b*=256);)l+=this[e+g]*b;return b*=128,l>=b&&(l-=Math.pow(2,8*t)),l},o.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||L(e,t,this.length);let l=t,b=1,g=this[e+--l];for(;l>0&&(b*=256);)g+=this[e+--l]*b;return b*=128,g>=b&&(g-=Math.pow(2,8*t)),g},o.prototype.readInt8=function(e,t){return e=e>>>0,t||L(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},o.prototype.readInt16LE=function(e,t){e=e>>>0,t||L(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i},o.prototype.readInt16BE=function(e,t){e=e>>>0,t||L(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i},o.prototype.readInt32LE=function(e,t){return e=e>>>0,t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e=e>>>0,t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readBigInt64LE=he(function(e){e=e>>>0,ge(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Oe(e,this.length-8);let l=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(l)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),o.prototype.readBigInt64BE=he(function(e){e=e>>>0,ge(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Oe(e,this.length-8);let l=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(l)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)}),o.prototype.readFloatLE=function(e,t){return e=e>>>0,t||L(e,4,this.length),n.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e=e>>>0,t||L(e,4,this.length),n.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||L(e,8,this.length),n.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||L(e,8,this.length),n.read(this,e,!1,52,8)};function C(r,e,t,i,l,b){if(!o.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>l||e<b)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(e,t,i,l){if(e=+e,t=t>>>0,i=i>>>0,!l){let F=Math.pow(2,8*i)-1;C(this,e,t,i,F,0)}let b=1,g=0;for(this[t]=e&255;++g<i&&(b*=256);)this[t+g]=e/b&255;return t+i},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(e,t,i,l){if(e=+e,t=t>>>0,i=i>>>0,!l){let F=Math.pow(2,8*i)-1;C(this,e,t,i,F,0)}let b=i-1,g=1;for(this[t+b]=e&255;--b>=0&&(g*=256);)this[t+b]=e/g&255;return t+i},o.prototype.writeUint8=o.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||C(this,e,t,1,255,0),this[t]=e&255,t+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||C(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||C(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||C(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||C(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function oe(r,e,t,i,l){it(e,i,l,r,t,7);let b=Number(e&BigInt(4294967295));r[t++]=b,b=b>>8,r[t++]=b,b=b>>8,r[t++]=b,b=b>>8,r[t++]=b;let g=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=g,g=g>>8,r[t++]=g,g=g>>8,r[t++]=g,g=g>>8,r[t++]=g,t}function Z(r,e,t,i,l){it(e,i,l,r,t,7);let b=Number(e&BigInt(4294967295));r[t+7]=b,b=b>>8,r[t+6]=b,b=b>>8,r[t+5]=b,b=b>>8,r[t+4]=b;let g=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=g,g=g>>8,r[t+2]=g,g=g>>8,r[t+1]=g,g=g>>8,r[t]=g,t+8}o.prototype.writeBigUInt64LE=he(function(e,t=0){return oe(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=he(function(e,t=0){return Z(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(e,t,i,l){if(e=+e,t=t>>>0,!l){let j=Math.pow(2,8*i-1);C(this,e,t,i,j-1,-j)}let b=0,g=1,F=0;for(this[t]=e&255;++b<i&&(g*=256);)e<0&&F===0&&this[t+b-1]!==0&&(F=1),this[t+b]=(e/g>>0)-F&255;return t+i},o.prototype.writeIntBE=function(e,t,i,l){if(e=+e,t=t>>>0,!l){let j=Math.pow(2,8*i-1);C(this,e,t,i,j-1,-j)}let b=i-1,g=1,F=0;for(this[t+b]=e&255;--b>=0&&(g*=256);)e<0&&F===0&&this[t+b+1]!==0&&(F=1),this[t+b]=(e/g>>0)-F&255;return t+i},o.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||C(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},o.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||C(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||C(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},o.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||C(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||C(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},o.prototype.writeBigInt64LE=he(function(e,t=0){return oe(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=he(function(e,t=0){return Z(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ye(r,e,t,i,l,b){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function v(r,e,t,i,l){return e=+e,t=t>>>0,l||ye(r,e,t,4),n.write(r,e,t,i,23,4),t+4}o.prototype.writeFloatLE=function(e,t,i){return v(this,e,t,!0,i)},o.prototype.writeFloatBE=function(e,t,i){return v(this,e,t,!1,i)};function Me(r,e,t,i,l){return e=+e,t=t>>>0,l||ye(r,e,t,8),n.write(r,e,t,i,52,8),t+8}o.prototype.writeDoubleLE=function(e,t,i){return Me(this,e,t,!0,i)},o.prototype.writeDoubleBE=function(e,t,i){return Me(this,e,t,!1,i)},o.prototype.copy=function(e,t,i,l){if(!o.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!l&&l!==0&&(l=this.length),t>=e.length&&(t=e.length),t||(t=0),l>0&&l<i&&(l=i),l===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(l<0)throw new RangeError("sourceEnd out of bounds");l>this.length&&(l=this.length),e.length-t<l-i&&(l=e.length-t+i);let b=l-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,l):Uint8Array.prototype.set.call(e,this.subarray(i,l),t),b},o.prototype.fill=function(e,t,i,l){if(typeof e=="string"){if(typeof t=="string"?(l=t,t=0,i=this.length):typeof i=="string"&&(l=i,i=this.length),l!==void 0&&typeof l!="string")throw new TypeError("encoding must be a string");if(typeof l=="string"&&!o.isEncoding(l))throw new TypeError("Unknown encoding: "+l);if(e.length===1){let g=e.charCodeAt(0);(l==="utf8"&&g<128||l==="latin1")&&(e=g)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let b;if(typeof e=="number")for(b=t;b<i;++b)this[b]=e;else{let g=o.isBuffer(e)?e:o.from(e,l),F=g.length;if(F===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(b=0;b<i-t;++b)this[b+t]=g[b%F]}return this};let _e={};function qe(r,e,t){_e[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(l){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:l,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}qe("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),qe("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError),qe("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,l=t;return Number.isInteger(t)&&Math.abs(t)>2**32?l=Ze(String(t)):typeof t=="bigint"&&(l=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(l=Ze(l)),l+="n"),i+=` It must be ${e}. Received ${l}`,i},RangeError);function Ze(r){let e="",t=r.length,i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function mt(r,e,t){ge(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&Oe(e,r.length-(t+1))}function it(r,e,t,i,l,b){if(r>t||r<e){let g=typeof e=="bigint"?"n":"",F;throw e===0||e===BigInt(0)?F=`>= 0${g} and < 2${g} ** ${(b+1)*8}${g}`:F=`>= -(2${g} ** ${(b+1)*8-1}${g}) and < 2 ** ${(b+1)*8-1}${g}`,new _e.ERR_OUT_OF_RANGE("value",F,r)}mt(i,l,b)}function ge(r,e){if(typeof r!="number")throw new _e.ERR_INVALID_ARG_TYPE(e,"number",r)}function Oe(r,e,t){throw Math.floor(r)!==r?(ge(r,t),new _e.ERR_OUT_OF_RANGE("offset","an integer",r)):e<0?new _e.ERR_BUFFER_OUT_OF_BOUNDS:new _e.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,r)}let Ne=/[^+/0-9A-Za-z-_]/g;function at(r){if(r=r.split("=")[0],r=r.trim().replace(Ne,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function He(r,e){e=e||1/0;let t,i=r.length,l=null,b=[];for(let g=0;g<i;++g){if(t=r.charCodeAt(g),t>55295&&t<57344){if(!l){if(t>56319){(e-=3)>-1&&b.push(239,191,189);continue}else if(g+1===i){(e-=3)>-1&&b.push(239,191,189);continue}l=t;continue}if(t<56320){(e-=3)>-1&&b.push(239,191,189),l=t;continue}t=(l-55296<<10|t-56320)+65536}else l&&(e-=3)>-1&&b.push(239,191,189);if(l=null,t<128){if((e-=1)<0)break;b.push(t)}else if(t<2048){if((e-=2)<0)break;b.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;b.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;b.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return b}function ke(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Qe(r,e){let t,i,l,b=[];for(let g=0;g<r.length&&!((e-=2)<0);++g)t=r.charCodeAt(g),i=t>>8,l=t%256,b.push(l),b.push(i);return b}function Ge(r){return a.toByteArray(at(r))}function $e(r,e,t,i){let l;for(l=0;l<i&&!(l+t>=e.length||l>=r.length);++l)e[l+t]=r[l];return l}function Ee(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function ot(r){return r!==r}let st=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let i=t*16;for(let l=0;l<16;++l)e[i+l]=r[t]+r[l]}return e}();function he(r){return typeof BigInt>"u"?ve:r}function ve(){throw new Error("BigInt not supported")}return Ye}var ft,In,Rt,Rn,Ye,Sn,Un=Fe(()=>{ee();te();ne();re();ft={},In=!1;Rt={},Rn=!1;Ye={},Sn=!1});var Ve,Te,$a,ja,On=Fe(()=>{ee();te();ne();re();Un();Ve=Bn();Ve.Buffer;Ve.SlowBuffer;Ve.INSPECT_MAX_BYTES;Ve.kMaxLength;Te=Ve.Buffer,$a=Ve.INSPECT_MAX_BYTES,ja=Ve.kMaxLength});var ne=Fe(()=>{On()});var Nn={};ar(Nn,{default:()=>yi});var yi,Dn=Fe(()=>{ee();te();ne();re();yi={}});var Ln=Tt((Cn,ze)=>{ee();te();ne();re();(function(a,n){typeof define=="function"&&define.amd?define([],n):typeof ir=="function"&&typeof ze=="object"&&ze&&ze.exports?ze.exports=n():(a.dcodeIO=a.dcodeIO||{}).bcrypt=n()})(Cn,function(){"use strict";var a={},n=null;function s(E){if(typeof ze<"u"&&ze&&ze.exports)try{return(Dn(),bi(Nn)).randomBytes(E)}catch{}try{var m;return(self.crypto||self.msCrypto).getRandomValues(m=new Uint32Array(E)),Array.prototype.slice.call(m)}catch{}if(!n)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return n(E)}var c=!1;try{s(1),c=!0}catch{}n=null,a.setRandomFallback=function(E){n=E},a.genSaltSync=function(E,m){if(E=E||U,typeof E!="number")throw Error("Illegal arguments: "+typeof E+", "+typeof m);E<4?E=4:E>31&&(E=31);var h=[];return h.push("$2a$"),E<10&&h.push("0"),h.push(E.toString()),h.push("$"),h.push(B(s(R),R)),h.join("")},a.genSalt=function(E,m,h){if(typeof m=="function"&&(h=m,m=void 0),typeof E=="function"&&(h=E,E=void 0),typeof E>"u")E=U;else if(typeof E!="number")throw Error("illegal arguments: "+typeof E);function p(x){d(function(){try{x(null,a.genSaltSync(E))}catch(y){x(y)}})}if(h){if(typeof h!="function")throw Error("Illegal callback: "+typeof h);p(h)}else return new Promise(function(x,y){p(function(I,P){if(I){y(I);return}x(P)})})},a.hashSync=function(E,m){if(typeof m>"u"&&(m=U),typeof m=="number"&&(m=a.genSaltSync(m)),typeof E!="string"||typeof m!="string")throw Error("Illegal arguments: "+typeof E+", "+typeof m);return We(E,m)},a.hash=function(E,m,h,p){function x(y){typeof E=="string"&&typeof m=="number"?a.genSalt(m,function(I,P){We(E,P,y,p)}):typeof E=="string"&&typeof m=="string"?We(E,m,y,p):d(y.bind(this,Error("Illegal arguments: "+typeof E+", "+typeof m)))}if(h){if(typeof h!="function")throw Error("Illegal callback: "+typeof h);x(h)}else return new Promise(function(y,I){x(function(P,N){if(P){I(P);return}y(N)})})};function u(E,m){for(var h=0,p=0,x=0,y=E.length;x<y;++x)E.charCodeAt(x)===m.charCodeAt(x)?++h:++p;return h<0?!1:p===0}a.compareSync=function(E,m){if(typeof E!="string"||typeof m!="string")throw Error("Illegal arguments: "+typeof E+", "+typeof m);return m.length!==60?!1:u(a.hashSync(E,m.substr(0,m.length-31)),m)},a.compare=function(E,m,h,p){function x(y){if(typeof E!="string"||typeof m!="string"){d(y.bind(this,Error("Illegal arguments: "+typeof E+", "+typeof m)));return}if(m.length!==60){d(y.bind(this,null,!1));return}a.hash(E,m.substr(0,29),function(I,P){I?y(I):y(null,u(P,m))},p)}if(h){if(typeof h!="function")throw Error("Illegal callback: "+typeof h);x(h)}else return new Promise(function(y,I){x(function(P,N){if(P){I(P);return}y(N)})})},a.getRounds=function(E){if(typeof E!="string")throw Error("Illegal arguments: "+typeof E);return parseInt(E.split("$")[2],10)},a.getSalt=function(E){if(typeof E!="string")throw Error("Illegal arguments: "+typeof E);if(E.length!==60)throw Error("Illegal hash length: "+E.length+" != 60");return E.substring(0,29)};var d=typeof fe<"u"&&fe&&typeof fe.nextTick=="function"?typeof setImmediate=="function"?setImmediate:fe.nextTick:setTimeout;function o(E){var m=[],h=0;return $.encodeUTF16toUTF8(function(){return h>=E.length?null:E.charCodeAt(h++)},function(p){m.push(p)}),m}var T="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),_=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1],S=String.fromCharCode;function B(E,m){var h=0,p=[],x,y;if(m<=0||m>E.length)throw Error("Illegal len: "+m);for(;h<m;){if(x=E[h++]&255,p.push(T[x>>2&63]),x=(x&3)<<4,h>=m){p.push(T[x&63]);break}if(y=E[h++]&255,x|=y>>4&15,p.push(T[x&63]),x=(y&15)<<2,h>=m){p.push(T[x&63]);break}y=E[h++]&255,x|=y>>6&3,p.push(T[x&63]),p.push(T[y&63])}return p.join("")}function M(E,m){var h=0,p=E.length,x=0,y=[],I,P,N,z,L,C;if(m<=0)throw Error("Illegal len: "+m);for(;h<p-1&&x<m&&(C=E.charCodeAt(h++),I=C<_.length?_[C]:-1,C=E.charCodeAt(h++),P=C<_.length?_[C]:-1,!(I==-1||P==-1||(L=I<<2>>>0,L|=(P&48)>>4,y.push(S(L)),++x>=m||h>=p)||(C=E.charCodeAt(h++),N=C<_.length?_[C]:-1,N==-1)||(L=(P&15)<<4>>>0,L|=(N&60)>>2,y.push(S(L)),++x>=m||h>=p)));)C=E.charCodeAt(h++),z=C<_.length?_[C]:-1,L=(N&3)<<6>>>0,L|=z,y.push(S(L)),++x;var oe=[];for(h=0;h<x;h++)oe.push(y[h].charCodeAt(0));return oe}var $=function(){"use strict";var E={};return E.MAX_CODEPOINT=1114111,E.encodeUTF8=function(m,h){var p=null;for(typeof m=="number"&&(p=m,m=function(){return null});p!==null||(p=m())!==null;)p<128?h(p&127):p<2048?(h(p>>6&31|192),h(p&63|128)):p<65536?(h(p>>12&15|224),h(p>>6&63|128),h(p&63|128)):(h(p>>18&7|240),h(p>>12&63|128),h(p>>6&63|128),h(p&63|128)),p=null},E.decodeUTF8=function(m,h){for(var p,x,y,I,P=function(N){N=N.slice(0,N.indexOf(null));var z=Error(N.toString());throw z.name="TruncatedError",z.bytes=N,z};(p=m())!==null;)if(!(p&128))h(p);else if((p&224)===192)(x=m())===null&&P([p,x]),h((p&31)<<6|x&63);else if((p&240)===224)((x=m())===null||(y=m())===null)&&P([p,x,y]),h((p&15)<<12|(x&63)<<6|y&63);else if((p&248)===240)((x=m())===null||(y=m())===null||(I=m())===null)&&P([p,x,y,I]),h((p&7)<<18|(x&63)<<12|(y&63)<<6|I&63);else throw RangeError("Illegal starting byte: "+p)},E.UTF16toUTF8=function(m,h){for(var p,x=null;(p=x!==null?x:m())!==null;){if(p>=55296&&p<=57343&&(x=m())!==null&&x>=56320&&x<=57343){h((p-55296)*1024+x-56320+65536),x=null;continue}h(p)}x!==null&&h(x)},E.UTF8toUTF16=function(m,h){var p=null;for(typeof m=="number"&&(p=m,m=function(){return null});p!==null||(p=m())!==null;)p<=65535?h(p):(p-=65536,h((p>>10)+55296),h(p%1024+56320)),p=null},E.encodeUTF16toUTF8=function(m,h){E.UTF16toUTF8(m,function(p){E.encodeUTF8(p,h)})},E.decodeUTF8toUTF16=function(m,h){E.decodeUTF8(m,function(p){E.UTF8toUTF16(p,h)})},E.calculateCodePoint=function(m){return m<128?1:m<2048?2:m<65536?3:4},E.calculateUTF8=function(m){for(var h,p=0;(h=m())!==null;)p+=E.calculateCodePoint(h);return p},E.calculateUTF16asUTF8=function(m){var h=0,p=0;return E.UTF16toUTF8(m,function(x){++h,p+=E.calculateCodePoint(x)}),[h,p]},E}();Date.now=Date.now||function(){return+new Date};var R=16,U=10,k=16,q=100,ie=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],J=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],G=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function H(E,m,h,p){var x,y=E[m],I=E[m+1];return y^=h[0],x=p[y>>>24],x+=p[256|y>>16&255],x^=p[512|y>>8&255],x+=p[768|y&255],I^=x^h[1],x=p[I>>>24],x+=p[256|I>>16&255],x^=p[512|I>>8&255],x+=p[768|I&255],y^=x^h[2],x=p[y>>>24],x+=p[256|y>>16&255],x^=p[512|y>>8&255],x+=p[768|y&255],I^=x^h[3],x=p[I>>>24],x+=p[256|I>>16&255],x^=p[512|I>>8&255],x+=p[768|I&255],y^=x^h[4],x=p[y>>>24],x+=p[256|y>>16&255],x^=p[512|y>>8&255],x+=p[768|y&255],I^=x^h[5],x=p[I>>>24],x+=p[256|I>>16&255],x^=p[512|I>>8&255],x+=p[768|I&255],y^=x^h[6],x=p[y>>>24],x+=p[256|y>>16&255],x^=p[512|y>>8&255],x+=p[768|y&255],I^=x^h[7],x=p[I>>>24],x+=p[256|I>>16&255],x^=p[512|I>>8&255],x+=p[768|I&255],y^=x^h[8],x=p[y>>>24],x+=p[256|y>>16&255],x^=p[512|y>>8&255],x+=p[768|y&255],I^=x^h[9],x=p[I>>>24],x+=p[256|I>>16&255],x^=p[512|I>>8&255],x+=p[768|I&255],y^=x^h[10],x=p[y>>>24],x+=p[256|y>>16&255],x^=p[512|y>>8&255],x+=p[768|y&255],I^=x^h[11],x=p[I>>>24],x+=p[256|I>>16&255],x^=p[512|I>>8&255],x+=p[768|I&255],y^=x^h[12],x=p[y>>>24],x+=p[256|y>>16&255],x^=p[512|y>>8&255],x+=p[768|y&255],I^=x^h[13],x=p[I>>>24],x+=p[256|I>>16&255],x^=p[512|I>>8&255],x+=p[768|I&255],y^=x^h[14],x=p[y>>>24],x+=p[256|y>>16&255],x^=p[512|y>>8&255],x+=p[768|y&255],I^=x^h[15],x=p[I>>>24],x+=p[256|I>>16&255],x^=p[512|I>>8&255],x+=p[768|I&255],y^=x^h[16],E[m]=I^h[k+1],E[m+1]=y,E}function X(E,m){for(var h=0,p=0;h<4;++h)p=p<<8|E[m]&255,m=(m+1)%E.length;return{key:p,offp:m}}function Ue(E,m,h){for(var p=0,x=[0,0],y=m.length,I=h.length,P,N=0;N<y;N++)P=X(E,p),p=P.offp,m[N]=m[N]^P.key;for(N=0;N<y;N+=2)x=H(x,0,m,h),m[N]=x[0],m[N+1]=x[1];for(N=0;N<I;N+=2)x=H(x,0,m,h),h[N]=x[0],h[N+1]=x[1]}function nt(E,m,h,p){for(var x=0,y=[0,0],I=h.length,P=p.length,N,z=0;z<I;z++)N=X(m,x),x=N.offp,h[z]=h[z]^N.key;for(x=0,z=0;z<I;z+=2)N=X(E,x),x=N.offp,y[0]^=N.key,N=X(E,x),x=N.offp,y[1]^=N.key,y=H(y,0,h,p),h[z]=y[0],h[z+1]=y[1];for(z=0;z<P;z+=2)N=X(E,x),x=N.offp,y[0]^=N.key,N=X(E,x),x=N.offp,y[1]^=N.key,y=H(y,0,h,p),p[z]=y[0],p[z+1]=y[1]}function Xe(E,m,h,p,x){var y=G.slice(),I=y.length,P;if(h<4||h>31)if(P=Error("Illegal number of rounds (4-31): "+h),p){d(p.bind(this,P));return}else throw P;if(m.length!==R)if(P=Error("Illegal salt length: "+m.length+" != "+R),p){d(p.bind(this,P));return}else throw P;h=1<<h>>>0;var N,z,L=0,C;Int32Array?(N=new Int32Array(ie),z=new Int32Array(J)):(N=ie.slice(),z=J.slice()),nt(m,E,N,z);function oe(){if(x&&x(L/h),L<h)for(var ye=Date.now();L<h&&(L=L+1,Ue(E,N,z),Ue(m,N,z),!(Date.now()-ye>q)););else{for(L=0;L<64;L++)for(C=0;C<I>>1;C++)H(y,C<<1,N,z);var v=[];for(L=0;L<I;L++)v.push((y[L]>>24&255)>>>0),v.push((y[L]>>16&255)>>>0),v.push((y[L]>>8&255)>>>0),v.push((y[L]&255)>>>0);if(p){p(null,v);return}else return v}p&&d(oe)}if(typeof p<"u")oe();else for(var Z;;)if(typeof(Z=oe())<"u")return Z||[]}function We(E,m,h,p){var x;if(typeof E!="string"||typeof m!="string")if(x=Error("Invalid string / salt: Not a string"),h){d(h.bind(this,x));return}else throw x;var y,I;if(m.charAt(0)!=="$"||m.charAt(1)!=="2")if(x=Error("Invalid salt version: "+m.substring(0,2)),h){d(h.bind(this,x));return}else throw x;if(m.charAt(2)==="$")y="\0",I=3;else{if(y=m.charAt(2),y!=="a"&&y!=="b"&&y!=="y"||m.charAt(3)!=="$")if(x=Error("Invalid salt revision: "+m.substring(2,4)),h){d(h.bind(this,x));return}else throw x;I=4}if(m.charAt(I+2)>"$")if(x=Error("Missing salt rounds"),h){d(h.bind(this,x));return}else throw x;var P=parseInt(m.substring(I,I+1),10)*10,N=parseInt(m.substring(I+1,I+2),10),z=P+N,L=m.substring(I+3,I+25);E+=y>="a"?"\0":"";var C=o(E),oe=M(L,R);function Z(ye){var v=[];return v.push("$2"),y>="a"&&v.push(y),v.push("$"),z<10&&v.push("0"),v.push(z.toString()),v.push("$"),v.push(B(oe,oe.length)),v.push(B(ye,G.length*4-1)),v.join("")}if(typeof h>"u")return Z(Xe(C,oe,z));Xe(C,oe,z,function(ye,v){ye?h(ye,null):h(null,Z(v))},p)}return a.encodeBase64=B,a.decodeBase64=M,a})});var Fn=Tt(kt=>{"use strict";ee();te();ne();re();kt.parse=Si;kt.serialize=Bi;var wi=Object.prototype.toString,Ti=Object.prototype.hasOwnProperty,Ai=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,_i=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,Ii=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,Ri=/^[\u0020-\u003A\u003D-\u007E]*$/;function Si(a,n){if(typeof a!="string")throw new TypeError("argument str must be a string");var s={},c=a.length;if(c<2)return s;var u=n&&n.decode||Ui,d=0,o=0,T=0;do{if(o=a.indexOf("=",d),o===-1)break;if(T=a.indexOf(";",d),T===-1)T=c;else if(o>T){d=a.lastIndexOf(";",o-1)+1;continue}var _=kn(a,d,o),S=vn(a,o,_),B=a.slice(_,S);if(!Ti.call(s,B)){var M=kn(a,o+1,T),$=vn(a,T,M);a.charCodeAt(M)===34&&a.charCodeAt($-1)===34&&(M++,$--);var R=a.slice(M,$);s[B]=Ni(R,u)}d=T+1}while(d<c);return s}function kn(a,n,s){do{var c=a.charCodeAt(n);if(c!==32&&c!==9)return n}while(++n<s);return s}function vn(a,n,s){for(;n>s;){var c=a.charCodeAt(--n);if(c!==32&&c!==9)return n+1}return s}function Bi(a,n,s){var c=s&&s.encode||encodeURIComponent;if(typeof c!="function")throw new TypeError("option encode is invalid");if(!Ai.test(a))throw new TypeError("argument name is invalid");var u=c(n);if(!_i.test(u))throw new TypeError("argument val is invalid");var d=a+"="+u;if(!s)return d;if(s.maxAge!=null){var o=Math.floor(s.maxAge);if(!isFinite(o))throw new TypeError("option maxAge is invalid");d+="; Max-Age="+o}if(s.domain){if(!Ii.test(s.domain))throw new TypeError("option domain is invalid");d+="; Domain="+s.domain}if(s.path){if(!Ri.test(s.path))throw new TypeError("option path is invalid");d+="; Path="+s.path}if(s.expires){var T=s.expires;if(!Oi(T)||isNaN(T.valueOf()))throw new TypeError("option expires is invalid");d+="; Expires="+T.toUTCString()}if(s.httpOnly&&(d+="; HttpOnly"),s.secure&&(d+="; Secure"),s.partitioned&&(d+="; Partitioned"),s.priority){var _=typeof s.priority=="string"?s.priority.toLowerCase():s.priority;switch(_){case"low":d+="; Priority=Low";break;case"medium":d+="; Priority=Medium";break;case"high":d+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(s.sameSite){var S=typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite;switch(S){case!0:d+="; SameSite=Strict";break;case"lax":d+="; SameSite=Lax";break;case"strict":d+="; SameSite=Strict";break;case"none":d+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return d}function Ui(a){return a.indexOf("%")!==-1?decodeURIComponent(a):a}function Oi(a){return wi.call(a)==="[object Date]"}function Ni(a,n){try{return n(a)}catch{return a}}});var $t=Tt((Ro,Kn)=>{"use strict";ee();te();ne();re();var{entries:Jn,setPrototypeOf:Pn,isFrozen:Di,getPrototypeOf:Ci,getOwnPropertyDescriptor:Li}=Object,{freeze:xe,seal:we,create:Xn}=Object,{apply:Ht,construct:Gt}=typeof Reflect<"u"&&Reflect;xe||(xe=function(n){return n});we||(we=function(n){return n});Ht||(Ht=function(n,s,c){return n.apply(s,c)});Gt||(Gt=function(n,s){return new n(...s)});var St=pe(Array.prototype.forEach),Mi=pe(Array.prototype.lastIndexOf),zn=pe(Array.prototype.pop),lt=pe(Array.prototype.push),ki=pe(Array.prototype.splice),Ut=pe(String.prototype.toLowerCase),vt=pe(String.prototype.toString),Wn=pe(String.prototype.match),dt=pe(String.prototype.replace),vi=pe(String.prototype.indexOf),Fi=pe(String.prototype.trim),Ae=pe(Object.prototype.hasOwnProperty),de=pe(RegExp.prototype.test),xt=Pi(TypeError);function pe(a){return function(n){n instanceof RegExp&&(n.lastIndex=0);for(var s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];return Ht(a,n,c)}}function Pi(a){return function(){for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return Gt(a,s)}}function W(a,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ut;Pn&&Pn(a,null);let c=n.length;for(;c--;){let u=n[c];if(typeof u=="string"){let d=s(u);d!==u&&(Di(n)||(n[c]=d),u=d)}a[u]=!0}return a}function zi(a){for(let n=0;n<a.length;n++)Ae(a,n)||(a[n]=null);return a}function Je(a){let n=Xn(null);for(let[s,c]of Jn(a))Ae(a,s)&&(Array.isArray(c)?n[s]=zi(c):c&&typeof c=="object"&&c.constructor===Object?n[s]=Je(c):n[s]=c);return n}function pt(a,n){for(;a!==null;){let c=Li(a,n);if(c){if(c.get)return pe(c.get);if(typeof c.value=="function")return pe(c.value)}a=Ci(a)}function s(){return null}return s}var Hn=xe(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ft=xe(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Pt=xe(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Wi=xe(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),zt=xe(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Hi=xe(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Gn=xe(["#text"]),$n=xe(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Wt=xe(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),jn=xe(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Bt=xe(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Gi=we(/\{\{[\w\W]*|[\w\W]*\}\}/gm),$i=we(/<%[\w\W]*|[\w\W]*%>/gm),ji=we(/\$\{[\w\W]*/gm),Yi=we(/^data-[\-\w.\u00B7-\uFFFF]+$/),Vi=we(/^aria-[\-\w]+$/),qn=we(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ji=we(/^(?:\w+script|data):/i),Xi=we(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Zn=we(/^html$/i),qi=we(/^[a-z][.\w]*(-[.\w]+)+$/i),Yn=Object.freeze({__proto__:null,ARIA_ATTR:Vi,ATTR_WHITESPACE:Xi,CUSTOM_ELEMENT:qi,DATA_ATTR:Yi,DOCTYPE_NAME:Zn,ERB_EXPR:$i,IS_ALLOWED_URI:qn,IS_SCRIPT_OR_DATA:Ji,MUSTACHE_EXPR:Gi,TMPLIT_EXPR:ji}),ht={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},Zi=function(){return typeof window>"u"?null:window},Qi=function(n,s){if(typeof n!="object"||typeof n.createPolicy!="function")return null;let c=null,u="data-tt-policy-suffix";s&&s.hasAttribute(u)&&(c=s.getAttribute(u));let d="dompurify"+(c?"#"+c:"");try{return n.createPolicy(d,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+d+" could not be created."),null}},Vn=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Qn(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zi(),n=D=>Qn(D);if(n.version="3.2.5",n.removed=[],!a||!a.document||a.document.nodeType!==ht.document||!a.Element)return n.isSupported=!1,n;let{document:s}=a,c=s,u=c.currentScript,{DocumentFragment:d,HTMLTemplateElement:o,Node:T,Element:_,NodeFilter:S,NamedNodeMap:B=a.NamedNodeMap||a.MozNamedAttrMap,HTMLFormElement:M,DOMParser:$,trustedTypes:R}=a,U=_.prototype,k=pt(U,"cloneNode"),q=pt(U,"remove"),ie=pt(U,"nextSibling"),J=pt(U,"childNodes"),G=pt(U,"parentNode");if(typeof o=="function"){let D=s.createElement("template");D.content&&D.content.ownerDocument&&(s=D.content.ownerDocument)}let H,X="",{implementation:Ue,createNodeIterator:nt,createDocumentFragment:Xe,getElementsByTagName:We}=s,{importNode:E}=c,m=Vn();n.isSupported=typeof Jn=="function"&&typeof G=="function"&&Ue&&Ue.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:h,ERB_EXPR:p,TMPLIT_EXPR:x,DATA_ATTR:y,ARIA_ATTR:I,IS_SCRIPT_OR_DATA:P,ATTR_WHITESPACE:N,CUSTOM_ELEMENT:z}=Yn,{IS_ALLOWED_URI:L}=Yn,C=null,oe=W({},[...Hn,...Ft,...Pt,...zt,...Gn]),Z=null,ye=W({},[...$n,...Wt,...jn,...Bt]),v=Object.seal(Xn(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Me=null,_e=null,qe=!0,Ze=!0,mt=!1,it=!0,ge=!1,Oe=!0,Ne=!1,at=!1,He=!1,ke=!1,Qe=!1,Ge=!1,$e=!0,Ee=!1,ot="user-content-",st=!0,he=!1,ve={},r=null,e=W({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),t=null,i=W({},["audio","video","img","source","image","track"]),l=null,b=W({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),g="http://www.w3.org/1998/Math/MathML",F="http://www.w3.org/2000/svg",j="http://www.w3.org/1999/xhtml",Y=j,Q=!1,V=null,ii=W({},[g,F,j],vt),gt=W({},["mi","mo","mn","ms","mtext"]),Et=W({},["annotation-xml"]),ai=W({},["title","style","font","a","script"]),ct=null,oi=["application/xhtml+xml","text/html"],si="text/html",ae=null,Ke=null,ci=s.createElement("form"),Yt=function(f){return f instanceof RegExp||f instanceof Function},Ot=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ke&&Ke===f)){if((!f||typeof f!="object")&&(f={}),f=Je(f),ct=oi.indexOf(f.PARSER_MEDIA_TYPE)===-1?si:f.PARSER_MEDIA_TYPE,ae=ct==="application/xhtml+xml"?vt:Ut,C=Ae(f,"ALLOWED_TAGS")?W({},f.ALLOWED_TAGS,ae):oe,Z=Ae(f,"ALLOWED_ATTR")?W({},f.ALLOWED_ATTR,ae):ye,V=Ae(f,"ALLOWED_NAMESPACES")?W({},f.ALLOWED_NAMESPACES,vt):ii,l=Ae(f,"ADD_URI_SAFE_ATTR")?W(Je(b),f.ADD_URI_SAFE_ATTR,ae):b,t=Ae(f,"ADD_DATA_URI_TAGS")?W(Je(i),f.ADD_DATA_URI_TAGS,ae):i,r=Ae(f,"FORBID_CONTENTS")?W({},f.FORBID_CONTENTS,ae):e,Me=Ae(f,"FORBID_TAGS")?W({},f.FORBID_TAGS,ae):{},_e=Ae(f,"FORBID_ATTR")?W({},f.FORBID_ATTR,ae):{},ve=Ae(f,"USE_PROFILES")?f.USE_PROFILES:!1,qe=f.ALLOW_ARIA_ATTR!==!1,Ze=f.ALLOW_DATA_ATTR!==!1,mt=f.ALLOW_UNKNOWN_PROTOCOLS||!1,it=f.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ge=f.SAFE_FOR_TEMPLATES||!1,Oe=f.SAFE_FOR_XML!==!1,Ne=f.WHOLE_DOCUMENT||!1,ke=f.RETURN_DOM||!1,Qe=f.RETURN_DOM_FRAGMENT||!1,Ge=f.RETURN_TRUSTED_TYPE||!1,He=f.FORCE_BODY||!1,$e=f.SANITIZE_DOM!==!1,Ee=f.SANITIZE_NAMED_PROPS||!1,st=f.KEEP_CONTENT!==!1,he=f.IN_PLACE||!1,L=f.ALLOWED_URI_REGEXP||qn,Y=f.NAMESPACE||j,gt=f.MATHML_TEXT_INTEGRATION_POINTS||gt,Et=f.HTML_INTEGRATION_POINTS||Et,v=f.CUSTOM_ELEMENT_HANDLING||{},f.CUSTOM_ELEMENT_HANDLING&&Yt(f.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(v.tagNameCheck=f.CUSTOM_ELEMENT_HANDLING.tagNameCheck),f.CUSTOM_ELEMENT_HANDLING&&Yt(f.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(v.attributeNameCheck=f.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),f.CUSTOM_ELEMENT_HANDLING&&typeof f.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(v.allowCustomizedBuiltInElements=f.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ge&&(Ze=!1),Qe&&(ke=!0),ve&&(C=W({},Gn),Z=[],ve.html===!0&&(W(C,Hn),W(Z,$n)),ve.svg===!0&&(W(C,Ft),W(Z,Wt),W(Z,Bt)),ve.svgFilters===!0&&(W(C,Pt),W(Z,Wt),W(Z,Bt)),ve.mathMl===!0&&(W(C,zt),W(Z,jn),W(Z,Bt))),f.ADD_TAGS&&(C===oe&&(C=Je(C)),W(C,f.ADD_TAGS,ae)),f.ADD_ATTR&&(Z===ye&&(Z=Je(Z)),W(Z,f.ADD_ATTR,ae)),f.ADD_URI_SAFE_ATTR&&W(l,f.ADD_URI_SAFE_ATTR,ae),f.FORBID_CONTENTS&&(r===e&&(r=Je(r)),W(r,f.FORBID_CONTENTS,ae)),st&&(C["#text"]=!0),Ne&&W(C,["html","head","body"]),C.table&&(W(C,["tbody"]),delete Me.tbody),f.TRUSTED_TYPES_POLICY){if(typeof f.TRUSTED_TYPES_POLICY.createHTML!="function")throw xt('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof f.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw xt('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');H=f.TRUSTED_TYPES_POLICY,X=H.createHTML("")}else H===void 0&&(H=Qi(R,u)),H!==null&&typeof X=="string"&&(X=H.createHTML(""));xe&&xe(f),Ke=f}},Vt=W({},[...Ft,...Pt,...Wi]),Jt=W({},[...zt,...Hi]),ui=function(f){let A=G(f);(!A||!A.tagName)&&(A={namespaceURI:Y,tagName:"template"});let O=Ut(f.tagName),K=Ut(A.tagName);return V[f.namespaceURI]?f.namespaceURI===F?A.namespaceURI===j?O==="svg":A.namespaceURI===g?O==="svg"&&(K==="annotation-xml"||gt[K]):!!Vt[O]:f.namespaceURI===g?A.namespaceURI===j?O==="math":A.namespaceURI===F?O==="math"&&Et[K]:!!Jt[O]:f.namespaceURI===j?A.namespaceURI===F&&!Et[K]||A.namespaceURI===g&&!gt[K]?!1:!Jt[O]&&(ai[O]||!Vt[O]):!!(ct==="application/xhtml+xml"&&V[f.namespaceURI]):!1},Ie=function(f){lt(n.removed,{element:f});try{G(f).removeChild(f)}catch{q(f)}},yt=function(f,A){try{lt(n.removed,{attribute:A.getAttributeNode(f),from:A})}catch{lt(n.removed,{attribute:null,from:A})}if(A.removeAttribute(f),f==="is")if(ke||Qe)try{Ie(A)}catch{}else try{A.setAttribute(f,"")}catch{}},Xt=function(f){let A=null,O=null;if(He)f="<remove></remove>"+f;else{let se=Wn(f,/^[\r\n\t ]+/);O=se&&se[0]}ct==="application/xhtml+xml"&&Y===j&&(f='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+f+"</body></html>");let K=H?H.createHTML(f):f;if(Y===j)try{A=new $().parseFromString(K,ct)}catch{}if(!A||!A.documentElement){A=Ue.createDocument(Y,"template",null);try{A.documentElement.innerHTML=Q?X:K}catch{}}let ce=A.body||A.documentElement;return f&&O&&ce.insertBefore(s.createTextNode(O),ce.childNodes[0]||null),Y===j?We.call(A,Ne?"html":"body")[0]:Ne?A.documentElement:ce},qt=function(f){return nt.call(f.ownerDocument||f,f,S.SHOW_ELEMENT|S.SHOW_COMMENT|S.SHOW_TEXT|S.SHOW_PROCESSING_INSTRUCTION|S.SHOW_CDATA_SECTION,null)},Nt=function(f){return f instanceof M&&(typeof f.nodeName!="string"||typeof f.textContent!="string"||typeof f.removeChild!="function"||!(f.attributes instanceof B)||typeof f.removeAttribute!="function"||typeof f.setAttribute!="function"||typeof f.namespaceURI!="string"||typeof f.insertBefore!="function"||typeof f.hasChildNodes!="function")},Zt=function(f){return typeof T=="function"&&f instanceof T};function De(D,f,A){St(D,O=>{O.call(n,f,A,Ke)})}let Qt=function(f){let A=null;if(De(m.beforeSanitizeElements,f,null),Nt(f))return Ie(f),!0;let O=ae(f.nodeName);if(De(m.uponSanitizeElement,f,{tagName:O,allowedTags:C}),f.hasChildNodes()&&!Zt(f.firstElementChild)&&de(/<[/\w!]/g,f.innerHTML)&&de(/<[/\w!]/g,f.textContent)||f.nodeType===ht.progressingInstruction||Oe&&f.nodeType===ht.comment&&de(/<[/\w]/g,f.data))return Ie(f),!0;if(!C[O]||Me[O]){if(!Me[O]&&er(O)&&(v.tagNameCheck instanceof RegExp&&de(v.tagNameCheck,O)||v.tagNameCheck instanceof Function&&v.tagNameCheck(O)))return!1;if(st&&!r[O]){let K=G(f)||f.parentNode,ce=J(f)||f.childNodes;if(ce&&K){let se=ce.length;for(let be=se-1;be>=0;--be){let Re=k(ce[be],!0);Re.__removalCount=(f.__removalCount||0)+1,K.insertBefore(Re,ie(f))}}}return Ie(f),!0}return f instanceof _&&!ui(f)||(O==="noscript"||O==="noembed"||O==="noframes")&&de(/<\/no(script|embed|frames)/i,f.innerHTML)?(Ie(f),!0):(ge&&f.nodeType===ht.text&&(A=f.textContent,St([h,p,x],K=>{A=dt(A,K," ")}),f.textContent!==A&&(lt(n.removed,{element:f.cloneNode()}),f.textContent=A)),De(m.afterSanitizeElements,f,null),!1)},Kt=function(f,A,O){if($e&&(A==="id"||A==="name")&&(O in s||O in ci))return!1;if(!(Ze&&!_e[A]&&de(y,A))){if(!(qe&&de(I,A))){if(!Z[A]||_e[A]){if(!(er(f)&&(v.tagNameCheck instanceof RegExp&&de(v.tagNameCheck,f)||v.tagNameCheck instanceof Function&&v.tagNameCheck(f))&&(v.attributeNameCheck instanceof RegExp&&de(v.attributeNameCheck,A)||v.attributeNameCheck instanceof Function&&v.attributeNameCheck(A))||A==="is"&&v.allowCustomizedBuiltInElements&&(v.tagNameCheck instanceof RegExp&&de(v.tagNameCheck,O)||v.tagNameCheck instanceof Function&&v.tagNameCheck(O))))return!1}else if(!l[A]){if(!de(L,dt(O,N,""))){if(!((A==="src"||A==="xlink:href"||A==="href")&&f!=="script"&&vi(O,"data:")===0&&t[f])){if(!(mt&&!de(P,dt(O,N,"")))){if(O)return!1}}}}}}return!0},er=function(f){return f!=="annotation-xml"&&Wn(f,z)},tr=function(f){De(m.beforeSanitizeAttributes,f,null);let{attributes:A}=f;if(!A||Nt(f))return;let O={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Z,forceKeepAttr:void 0},K=A.length;for(;K--;){let ce=A[K],{name:se,namespaceURI:be,value:Re}=ce,ut=ae(se),le=se==="value"?Re:Fi(Re);if(O.attrName=ut,O.attrValue=le,O.keepAttr=!0,O.forceKeepAttr=void 0,De(m.uponSanitizeAttribute,f,O),le=O.attrValue,Ee&&(ut==="id"||ut==="name")&&(yt(se,f),le=ot+le),Oe&&de(/((--!?|])>)|<\/(style|title)/i,le)){yt(se,f);continue}if(O.forceKeepAttr||(yt(se,f),!O.keepAttr))continue;if(!it&&de(/\/>/i,le)){yt(se,f);continue}ge&&St([h,p,x],nr=>{le=dt(le,nr," ")});let rr=ae(f.nodeName);if(Kt(rr,ut,le)){if(H&&typeof R=="object"&&typeof R.getAttributeType=="function"&&!be)switch(R.getAttributeType(rr,ut)){case"TrustedHTML":{le=H.createHTML(le);break}case"TrustedScriptURL":{le=H.createScriptURL(le);break}}try{be?f.setAttributeNS(be,se,le):f.setAttribute(se,le),Nt(f)?Ie(f):zn(n.removed)}catch{}}}De(m.afterSanitizeAttributes,f,null)},fi=function D(f){let A=null,O=qt(f);for(De(m.beforeSanitizeShadowDOM,f,null);A=O.nextNode();)De(m.uponSanitizeShadowNode,A,null),Qt(A),tr(A),A.content instanceof d&&D(A.content);De(m.afterSanitizeShadowDOM,f,null)};return n.sanitize=function(D){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},A=null,O=null,K=null,ce=null;if(Q=!D,Q&&(D="<!-->"),typeof D!="string"&&!Zt(D))if(typeof D.toString=="function"){if(D=D.toString(),typeof D!="string")throw xt("dirty is not a string, aborting")}else throw xt("toString is not a function");if(!n.isSupported)return D;if(at||Ot(f),n.removed=[],typeof D=="string"&&(he=!1),he){if(D.nodeName){let Re=ae(D.nodeName);if(!C[Re]||Me[Re])throw xt("root node is forbidden and cannot be sanitized in-place")}}else if(D instanceof T)A=Xt("<!---->"),O=A.ownerDocument.importNode(D,!0),O.nodeType===ht.element&&O.nodeName==="BODY"||O.nodeName==="HTML"?A=O:A.appendChild(O);else{if(!ke&&!ge&&!Ne&&D.indexOf("<")===-1)return H&&Ge?H.createHTML(D):D;if(A=Xt(D),!A)return ke?null:Ge?X:""}A&&He&&Ie(A.firstChild);let se=qt(he?D:A);for(;K=se.nextNode();)Qt(K),tr(K),K.content instanceof d&&fi(K.content);if(he)return D;if(ke){if(Qe)for(ce=Xe.call(A.ownerDocument);A.firstChild;)ce.appendChild(A.firstChild);else ce=A;return(Z.shadowroot||Z.shadowrootmode)&&(ce=E.call(c,ce,!0)),ce}let be=Ne?A.outerHTML:A.innerHTML;return Ne&&C["!doctype"]&&A.ownerDocument&&A.ownerDocument.doctype&&A.ownerDocument.doctype.name&&de(Zn,A.ownerDocument.doctype.name)&&(be="<!DOCTYPE "+A.ownerDocument.doctype.name+`>
`+be),ge&&St([h,p,x],Re=>{be=dt(be,Re," ")}),H&&Ge?H.createHTML(be):be},n.setConfig=function(){let D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ot(D),at=!0},n.clearConfig=function(){Ke=null,at=!1},n.isValidAttribute=function(D,f,A){Ke||Ot({});let O=ae(D),K=ae(f);return Kt(O,K,A)},n.addHook=function(D,f){typeof f=="function"&&lt(m[D],f)},n.removeHook=function(D,f){if(f!==void 0){let A=Mi(m[D],f);return A===-1?void 0:ki(m[D],A,1)[0]}return zn(m[D])},n.removeHooks=function(D){m[D]=[]},n.removeAllHooks=function(){m=Vn()},n}var Ki=Qn();Kn.exports=Ki});var ti=Tt((No,ei)=>{ee();te();ne();re();ei.exports=window.DOMPurify||(window.DOMPurify=$t().default||$t())});ee();te();ne();re();var rt=Dt(Ln());ee();te();ne();re();ee();te();ne();re();var Mn=(a=21)=>crypto.getRandomValues(new Uint8Array(a)).reduce((n,s)=>(s&=63,s<36?n+=s.toString(36):s<62?n+=(s-26).toString(36).toUpperCase():s>62?n+="-":n+="_",n),"");var ri=Dt(Fn()),ni=Dt(ti()),bt="library_session",ea={"student.pkujx.cn":"student","pkujx.cn":"teacher","qq.com":"student","gmail.com":"student","outlook.com":"student"};function w(a,n){return new Response(JSON.stringify({success:!1,message:a}),{status:n,headers:{"Content-Type":"application/json"}})}async function ta(a,n,s){let c=await me(a,n);if(!c.authorized)return w(c.error,c.error.startsWith("Unauthorized")?401:403);if(!s)return w("ISBN is required in the path.",400);try{let u=await tt(n,s);if(!u)return w("Book with the given ISBN not found.",404);let d=await a.json(),{title:o,author:T,publisher:_,publication_date:S,category_id:B,total_copies:M,available_copies:$,status:R}=d,U=[],k=[];if(o!==void 0&&(U.push("title = ?"),k.push(o)),T!==void 0&&(U.push("author = ?"),k.push(T)),_!==void 0&&(U.push("publisher = ?"),k.push(_)),S!==void 0&&(U.push("publication_date = ?"),k.push(S)),B!==void 0&&(U.push("category_id = ?"),k.push(parseInt(B))),M!==void 0){let G=parseInt(M);if(isNaN(G)||G<0)return w("Invalid total_copies value.",400);U.push("total_copies = ?"),k.push(G)}if($!==void 0){let G=parseInt($);if(isNaN(G)||G<0)return w("Invalid available_copies value.",400);if(M!==void 0&&G>parseInt(M))return w("Available copies cannot exceed total copies.",400);if(M===void 0&&u&&G>u.total_copies)return w("Available copies cannot exceed current total copies.",400);U.push("available_copies = ?"),k.push(G)}if(R!==void 0&&(U.push("status = ?"),k.push(R)),U.length===0)return w("No fields provided for update.",400);k.push(s);let q=`UPDATE books SET ${U.join(", ")} WHERE isbn = ?`,{success:ie,meta:J}=await n.DB.prepare(q).bind(...k).run();if(ie&&J&&J.changes>0){let G=await tt(n,s);return new Response(JSON.stringify({success:!0,message:"Book updated successfully.",book:G}),{status:200,headers:{"Content-Type":"application/json"}})}else return J&&J.changes===0?w("No changes made to the book or book not found.",304):w("Failed to update book.",500)}catch(u){return console.error("Edit Book API Error:",u),u.message&&u.message.includes("UNIQUE constraint failed")?w("Update failed due to a unique constraint violation (e.g., new ISBN if you were allowing ISBN change).",409):w("Internal Server Error: "+u.message,500)}}async function tt(a,n){let{results:s}=await a.DB.prepare("SELECT * FROM books WHERE isbn = ? LIMIT 1").bind(n).all();return s&&s.length>0?s[0]:null}async function ra(a,n){let{isbn:s,title:c,author:u,publisher:d,publication_date:o,category_id:T,total_copies:_,status:S}=n;try{return await a.DB.prepare("INSERT INTO books (isbn, title, author, publisher, publication_date, category_id, total_copies, available_copies, status) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)").bind(s,c,u,d,o,T,_,_,S).run(),!0}catch(B){return console.error("\u6DFB\u52A0\u56FE\u4E66\u5931\u8D25\uFF1A",B),!1}}async function me(a,n){let s=a.headers.get("Cookie");if(!s)return{authorized:!1,error:"Unauthorized: No cookie provided"};let c=s.split(";"),u=null;for(let d of c){let o=d.trim();if(o.startsWith(`${bt}=`)){u=o.substring(`${bt}=`.length);break}}if(!u)return{authorized:!1,error:"Unauthorized: Invalid session cookie format"};try{let{results:d}=await n.DB.prepare("SELECT user_id, role FROM sessions WHERE id = ? AND expiry > ? LIMIT 1").bind(u,Date.now()).all();if(!d||d.length===0)return{authorized:!1,error:"Unauthorized: Invalid or expired session"};let o=d[0];return o.role!=="admin"?{authorized:!1,error:"Forbidden: Insufficient privileges"}:{authorized:!0,userId:o.user_id,role:o.role}}catch(d){return console.error("\u9A8C\u8BC1\u7BA1\u7406\u5458\u8EAB\u4EFD\u5931\u8D25\uFF1A",d),{authorized:!1,error:"Internal Server Error: Failed to verify admin status"}}}async function na(a,n){let s=await me(a,n);if(!s.authorized)return w(s.error,s.error.startsWith("Unauthorized")?401:403);try{let c=await a.json(),{isbn:u,title:d,author:o,publisher:T,publication_date:_,category_id:S,total_copies:B,status:M}=c;if(!u||!d||!S)return w("Missing required fields (isbn, title, category_id)",400);if(await tt(n,u))return w("ISBN already exists",409);let R={isbn:u,title:d,author:o||null,publisher:T||null,publication_date:_||null,category_id:S,total_copies:B||1,status:M||"\u5728\u9986"};return await ra(n,R)?new Response(JSON.stringify({success:!0,message:"Book added successfully",book:R}),{status:201,headers:{"Content-Type":"application/json"}}):w("Failed to add book",500)}catch(c){return console.error("\u6DFB\u52A0\u56FE\u4E66 API \u9519\u8BEF\uFF1A",c),w("Internal Server Error: "+c.message,500)}}async function ia(a,n){try{return await a.DB.prepare("DELETE FROM books WHERE isbn = ?").bind(n).run(),!0}catch(s){return console.error("\u5220\u9664\u56FE\u4E66\u5931\u8D25\uFF1A",s),!1}}async function aa(a,n){let s=await me(a,n);if(!s.authorized)return w(s.error,s.error.startsWith("Unauthorized")?401:403);try{let c=await a.json(),{isbn:u}=c;if(!u)return w("Missing required field (isbn)",400);if(!await tt(n,u))return w("ISBN not found",404);let{results:o}=await n.DB.prepare("SELECT COUNT(*) AS count FROM borrowed_books WHERE isbn = ? AND returned = 0").bind(u).first();return o&&o.count>0?w("Book has unreturned borrow records and cannot be deleted",409):await ia(n,u)?new Response(JSON.stringify({success:!0,message:"Book deleted successfully"}),{status:200,headers:{"Content-Type":"application/json"}}):w("Failed to delete book",500)}catch(c){return console.error("\u5220\u9664\u56FE\u4E66 API \u9519\u8BEF\uFF1A",c),w("Internal Server Error: "+c.message,500)}}async function jt(a,n){let s=a.headers.get("Cookie");if(!s)return{authorized:!1,error:"Unauthorized: No cookie provided"};let c=s.split(";"),u=null;for(let d of c){let o=d.trim();if(o.startsWith(`${bt}=`)){u=o.substring(`${bt}=`.length);break}}if(!u)return{authorized:!1,error:"Unauthorized: Invalid session cookie format"};try{let{results:d}=await n.DB.prepare("SELECT user_id, role FROM sessions WHERE id = ? AND expiry > ? LIMIT 1").bind(u,Date.now()).all();return!d||d.length===0?{authorized:!1,error:"Unauthorized: Invalid or expired session"}:{authorized:!0,userId:d[0].user_id,role:d[0].role}}catch(d){return console.error("\u9A8C\u8BC1\u7528\u6237\u8EAB\u4EFD\u5931\u8D25\uFF1A",d),{authorized:!1,error:"Internal Server Error: Failed to verify user status"}}}async function oa(a,n){let s=await jt(a,n);if(!s.authorized)return w(s.error,401);try{let c=new URL(a.url),u=c.searchParams.get("isbn"),d=c.searchParams.get("title"),o=c.searchParams.get("author"),T=c.searchParams.get("category_id"),_=c.searchParams.get("status"),S="SELECT * FROM books WHERE 1=1",B=[];u&&(S+=" AND isbn = ?",B.push(u)),d&&(S+=" AND title LIKE ?",B.push(`%${d}%`)),o&&(S+=" AND author LIKE ?",B.push(`%${o}%`)),T&&(S+=" AND category_id = ?",B.push(T)),_&&(S+=" AND status = ?",B.push(_));let{results:M}=await n.DB.prepare(S).bind(...B).all();return new Response(JSON.stringify({success:!0,results:M}),{status:200,headers:{"Content-Type":"application/json"}})}catch(c){return console.error("\u67E5\u627E\u56FE\u4E66 API \u9519\u8BEF\uFF1A",c),w("Internal Server Error: "+c.message,500)}}async function sa(a,n,s,c){try{let u=new Date().toISOString().split("T")[0];return await a.DB.prepare("INSERT INTO borrowed_books (isbn, user_id, borrow_date, due_date, returned) VALUES (?, ?, ?, ?, ?)").bind(n,s,u,c,0).run(),await a.DB.prepare("UPDATE books SET available_copies = available_copies - 1 WHERE isbn = ?").bind(n).run(),!0}catch(u){return console.error("\u501F\u9605\u56FE\u4E66\u5931\u8D25\uFF1A",u),!1}}async function ca(a,n){let s=await me(a,n);if(!s.authorized)return w(s.error,s.error.startsWith("Unauthorized")?401:403);try{let c=await a.json(),{isbn:u,user_id:d,due_date:o}=c;if(!u||!d||!o)return w("Missing required fields (isbn, user_id, due_date)",400);if(!/^\d{4}-\d{2}-\d{2}$/.test(o))return w("Invalid due_date format. Use YYYY-MM-DD",400);let T=await tt(n,u);if(!T)return w("ISBN not found",404);let{results:_}=await n.DB.prepare("SELECT id FROM users WHERE id = ? LIMIT 1").bind(d).all();return!_||_.length===0?w("User ID not found",404):T.available_copies<=0?w("No available copies of this book",409):await sa(n,u,d,o)?new Response(JSON.stringify({success:!0,message:"Book borrowed successfully"}),{status:200,headers:{"Content-Type":"application/json"}}):w("Failed to borrow book",500)}catch(c){return console.error("\u501F\u9605\u56FE\u4E66 API \u9519\u8BEF\uFF1A",c),w("Internal Server Error: "+c.message,500)}}async function ua(a,n,s){try{let c=new Date().toISOString().split("T")[0],{changes:u}=await a.DB.prepare("UPDATE borrowed_books SET returned = 1, return_date = ? WHERE isbn = ? AND user_id = ? AND returned = 0").bind(c,n,s).run();return u===0?!1:(await a.DB.prepare("UPDATE books SET available_copies = available_copies + 1 WHERE isbn = ?").bind(n).run(),!0)}catch(c){return console.error("\u5F52\u8FD8\u56FE\u4E66\u5931\u8D25\uFF1A",c),!1}}async function fa(a,n){let s=await me(a,n);if(!s.authorized)return w(s.error,s.error.startsWith("Unauthorized")?401:403);try{let c=await a.json(),{isbn:u,user_id:d}=c;if(!u||!d)return w("Missing required fields (isbn, user_id)",400);if(!await tt(n,u))return w("ISBN not found",404);let{results:T}=await n.DB.prepare("SELECT id FROM users WHERE id = ? LIMIT 1").bind(d).all();if(!T||T.length===0)return w("User ID not found",404);let{results:_}=await n.DB.prepare("SELECT id FROM borrowed_books WHERE isbn = ? AND user_id = ? AND returned = 0 LIMIT 1").bind(u,d).all();return!_||_.length===0?w("No active borrow record found for this user and book",404):await ua(n,u,d)?new Response(JSON.stringify({success:!0,message:"Book returned successfully"}),{status:200,headers:{"Content-Type":"application/json"}}):w("Failed to return book",500)}catch(c){return console.error("\u5F52\u8FD8\u56FE\u4E66 API \u9519\u8BEF\uFF1A",c),w("Internal Server Error: "+c.message,500)}}async function la(a,n){let s=await me(a,n);if(!s.authorized)return w(s.error,s.error.startsWith("Unauthorized")?401:403);try{switch(new URL(a.url).searchParams.get("action")){case"borrowed_records":return da(a,n);case"overdue":return xa(a,n);case"book_status":return pa(a,n);default:return w("Invalid action",400)}}catch(c){return console.error("Admin Library API \u9519\u8BEF\uFF1A",c),w("Internal Server Error: "+c.message,500)}}async function da(a,n){let s=new URL(a.url),c=s.searchParams.get("user_id"),u=s.searchParams.get("isbn"),d=s.searchParams.get("returned"),o=s.searchParams.get("current"),T="SELECT bb.*, u.username, b.title as book_title FROM borrowed_books bb JOIN users u ON bb.user_id = u.id JOIN books b ON bb.isbn = b.isbn WHERE 1=1",_=[];c&&(T+=" AND bb.user_id = ?",_.push(c)),u&&(T+=" AND bb.isbn = ?",_.push(u)),d&&(T+=" AND bb.returned = ?",_.push(d)),o==="1"&&(T+=" AND bb.returned = 0");try{let{results:S}=await n.DB.prepare(T).bind(..._).all();return new Response(JSON.stringify({success:!0,results:S}),{status:200,headers:{"Content-Type":"application/json"}})}catch(S){return console.error("\u501F\u9605\u8BB0\u5F55\u67E5\u8BE2\u9519\u8BEF\uFF1A",S),w("Internal Server Error: "+S.message,500)}}async function xa(a,n){let s=new Date().toISOString().slice(0,10),c="SELECT bb.*, u.username, b.title as book_title FROM borrowed_books bb JOIN users u ON bb.user_id = u.id JOIN books b ON bb.isbn = b.isbn WHERE bb.due_date < ? AND bb.returned = 0";try{let{results:u}=await n.DB.prepare(c).bind(s).all();return new Response(JSON.stringify({success:!0,results:u}),{status:200,headers:{"Content-Type":"application/json"}})}catch(u){return console.error("\u903E\u671F\u7BA1\u7406\u9519\u8BEF\uFF1A",u),w("Internal Server Error: "+u.message,500)}}async function pa(a,n){let c=new URL(a.url).searchParams.get("status");if(!c)return w("Missing required parameter: status",400);let u="SELECT * FROM books WHERE status = ?";try{let{results:d}=await n.DB.prepare(u).bind(c).all();return new Response(JSON.stringify({success:!0,results:d}),{status:200,headers:{"Content-Type":"application/json"}})}catch(d){return console.error("\u56FE\u4E66\u72B6\u6001\u7BA1\u7406\u9519\u8BEF\uFF1A",d),w("Internal Server Error: "+d.message,500)}}async function ha(a,n){try{let{email:s,password:c,username:u}=await a.json();if(!s||!c||!u)return w("Email, password, and username are required",400);if(!s.includes("@"))return w("Invalid email format",400);let d=s.split("@")[1],o=ea[d];if(!o)return w("Email domain is not allowed",400);let{results:T}=await n.DB.prepare("SELECT id FROM users WHERE email = ? LIMIT 1").bind(s).all();if(T&&T.length>0)return w("Email already registered",409);let S=await rt.hash(c,10),{success:B}=await n.DB.prepare("INSERT INTO users (email, username, password, role) VALUES (?, ?, ?, ?)").bind(s,u,S,o).run();return B?new Response(JSON.stringify({success:!0,message:"Registration successful"}),{status:201,headers:{"Content-Type":"application/json"}}):w("Registration failed",500)}catch(s){return console.error("\u6CE8\u518C\u9519\u8BEF\uFF1A",s),w("Registration failed, please try again later",500)}}async function ba(a,n){try{let{email:s,password:c}=await a.json();if(!s||!c)return w("Email and password are required",400);let{results:u}=await n.DB.prepare("SELECT id, email, username, password, role FROM users WHERE email = ? LIMIT 1").bind(s).all();if(!u||u.length===0)return w("User not found or incorrect credentials",401);let d=u[0];if(!await rt.compare(c,d.password))return w("User not found or incorrect credentials",401);let T=Mn(),_=Date.now()+24*60*60*1e3;await n.DB.prepare("INSERT INTO sessions (id, user_id, email, username, role, expiry) VALUES (?, ?, ?, ?, ?, ?)").bind(T,d.id,d.email,d.username,d.role,_).run();let S=(0,ri.serialize)(bt,T,{httpOnly:!0,secure:!0,sameSite:"None",path:"/",expires:new Date(_)});return new Response(JSON.stringify({success:!0,message:"Login successful",user:{id:d.id,email:d.email,username:d.username,role:d.role,sessionId:T}}),{status:200,headers:{"Content-Type":"application/json","Set-Cookie":S}})}catch(s){return console.error("\u767B\u5F55\u9519\u8BEF\uFF1A",s),w("Login failed, please try again later",500)}}async function ma(a,n){let s=await jt(a,n);if(!s.authorized)return w(s.error,401);try{let{results:c}=await n.DB.prepare("SELECT id, email, username, role FROM users WHERE id = ? LIMIT 1").bind(s.userId).all();if(!c||c.length===0)return w("User not found",404);let u=c[0];return new Response(JSON.stringify({success:!0,user:{id:u.id,email:u.email,username:u.username,role:u.role}}),{status:200,headers:{"Content-Type":"application/json"}})}catch(c){return console.error("\u5904\u7406 /api/user GET \u8BF7\u6C42\u65F6\u53D1\u751F\u9519\u8BEF\uFF1A",c),w("Internal Server Error",500)}}async function ga(a,n){let s=await me(a,n);if(!s.authorized)return w(s.error,s.error.startsWith("Unauthorized")?401:403);try{let c=new URL(a.url),u=c.searchParams.get("search"),d=c.searchParams.get("role"),o="SELECT id, username, email, role, created_at FROM users WHERE 1=1",T=[];u&&(o+=" AND (username LIKE ? OR email LIKE ?)",T.push(`%${u}%`,`%${u}%`)),d&&(o+=" AND role = ?",T.push(d)),o+=" ORDER BY created_at DESC";let{results:_}=await n.DB.prepare(o).bind(...T).all();return new Response(JSON.stringify({success:!0,users:_}),{status:200,headers:{"Content-Type":"application/json"}})}catch(c){return console.error("Admin Get Users API Error:",c),w("Internal Server Error: "+c.message,500)}}async function Ea(a,n,s){let c=await me(a,n);if(!c.authorized)return w(c.error,c.error.startsWith("Unauthorized")?401:403);if(!s)return w("User ID is required in the path.",400);try{let{results:u}=await n.DB.prepare("SELECT id, username, email, role, created_at FROM users WHERE id = ? LIMIT 1").bind(s).all();return!u||u.length===0?w("User not found.",404):new Response(JSON.stringify({success:!0,user:u[0]}),{status:200,headers:{"Content-Type":"application/json"}})}catch(u){return console.error("Admin Get User By ID API Error:",u),w("Internal Server Error: "+u.message,500)}}async function ya(a,n){let s=await me(a,n);if(!s.authorized)return w(s.error,s.error.startsWith("Unauthorized")?401:403);try{let{email:c,password:u,username:d,role:o}=await a.json();if(!c||!u||!d||!o)return w("Email, password, username, and role are required.",400);if(!["student","teacher","admin"].includes(o))return w("Invalid role. Must be student, teacher, or admin.",400);if(!c.includes("@"))return w("Invalid email format.",400);let{results:T}=await n.DB.prepare("SELECT id FROM users WHERE email = ? LIMIT 1").bind(c).all();if(T&&T.length>0)return w("Email already registered.",409);let S=await rt.hash(u,10),{meta:B}=await n.DB.prepare("INSERT INTO users (email, username, password, role) VALUES (?, ?, ?, ?)").bind(c,d,S,o).run();if(B&&B.last_row_id){let M={id:B.last_row_id,email:c,username:d,role:o};return new Response(JSON.stringify({success:!0,message:"User created successfully.",user:M}),{status:201,headers:{"Content-Type":"application/json"}})}else return w("Failed to create user.",500)}catch(c){return console.error("Admin Create User API Error:",c),c.message&&c.message.includes("UNIQUE constraint failed")?w("Failed to create user. A unique field (like username or email) might already exist.",409):w("Internal Server Error: "+c.message,500)}}async function wa(a,n,s){let c=await me(a,n);if(!c.authorized)return w(c.error,c.error.startsWith("Unauthorized")?401:403);if(!s)return w("User ID is required in the path.",400);try{let{username:u,email:d,role:o,newPassword:T}=await a.json(),{results:_}=await n.DB.prepare("SELECT id FROM users WHERE id = ? LIMIT 1").bind(s).all();if(!_||_.length===0)return w("User not found.",404);let S=[],B=[];if(u&&(S.push("username = ?"),B.push(u)),d){if(!d.includes("@"))return w("Invalid email format.",400);let{results:R}=await n.DB.prepare("SELECT id FROM users WHERE email = ? AND id != ? LIMIT 1").bind(d,s).all();if(R&&R.length>0)return w("Email already in use by another account.",409);S.push("email = ?"),B.push(d)}if(o){if(!["student","teacher","admin"].includes(o))return w("Invalid role. Must be student, teacher, or admin.",400);S.push("role = ?"),B.push(o)}if(T){let U=await rt.hash(T,10);S.push("password = ?"),B.push(U)}if(S.length===0)return w("No fields provided for update.",400);B.push(s);let M=`UPDATE users SET ${S.join(", ")} WHERE id = ?`,{success:$}=await n.DB.prepare(M).bind(...B).run();if($){let{results:R}=await n.DB.prepare("SELECT id, username, email, role, created_at FROM users WHERE id = ? LIMIT 1").bind(s).all();return new Response(JSON.stringify({success:!0,message:"User updated successfully.",user:R[0]}),{status:200,headers:{"Content-Type":"application/json"}})}else return w("Failed to update user.",500)}catch(u){return console.error("Admin Update User API Error:",u),u.message&&u.message.includes("UNIQUE constraint failed")?w("Failed to update user. A unique field (like new username or email) might conflict.",409):w("Internal Server Error: "+u.message,500)}}async function Ta(a,n,s){let c=await me(a,n);if(!c.authorized)return w(c.error,c.error.startsWith("Unauthorized")?401:403);if(!s)return w("User ID is required in the path.",400);try{let{results:u}=await n.DB.prepare("SELECT id FROM users WHERE id = ? LIMIT 1").bind(s).all();if(!u||u.length===0)return w("User not found.",404);let{results:d}=await n.DB.prepare("SELECT COUNT(*) AS count FROM borrowed_books WHERE user_id = ? AND returned = 0").bind(s).first();if(d&&d.count>0)return w(`Cannot delete user. User has ${d.count} unreturned book(s).`,409);await n.DB.prepare("DELETE FROM sessions WHERE user_id = ?").bind(s).run();let{success:o}=await n.DB.prepare("DELETE FROM users WHERE id = ?").bind(s).run();return o?new Response(JSON.stringify({success:!0,message:"User deleted successfully."}),{status:200,headers:{"Content-Type":"application/json"}}):w("Failed to delete user.",500)}catch(u){return console.error("Admin Delete User API Error:",u),w("Internal Server Error: "+u.message,500)}}async function Aa(a,n){let s=await jt(a,n);if(!s.authorized)return w(s.error,401);try{let c=new URL(a.url),u=c.searchParams.get("days"),d=c.searchParams.get("limit"),o=parseInt(u)||30,T=parseInt(d)||10;if(o<=0||T<=0)return w("Parameters 'days' and 'limit' must be positive integers.",400);let _=new Date;_.setDate(_.getDate()-o);let S=_.toISOString().split("T")[0],B=`
            SELECT
                u.id AS user_id,
                u.username,
                u.email, 
                COUNT(bb.id) AS borrow_count
            FROM borrowed_books bb
            JOIN users u ON bb.user_id = u.id
            WHERE bb.borrow_date >= ?
            GROUP BY u.id, u.username, u.email
            ORDER BY borrow_count DESC
            LIMIT ?
        `,{results:M}=await n.DB.prepare(B).bind(S,T).all();return new Response(JSON.stringify({success:!0,topBorrowers:M}),{status:200,headers:{"Content-Type":"application/json"}})}catch(c){return console.error("Get Top Borrowers API Error:",c),w("Internal Server Error: "+c.message,500)}}async function _a(a,n){let s=await me(a,n);if(!s.authorized)return w(s.error,s.error.startsWith("Unauthorized")?401:403);try{let{results:c}=await n.DB.prepare("SELECT COUNT(*) as count FROM books").first(),u=c?c.count:0,{results:d}=await n.DB.prepare("SELECT COUNT(*) as count FROM users").first(),o=d?d.count:0,{results:T}=await n.DB.prepare("SELECT COUNT(*) as count FROM borrowed_books WHERE returned = 0").first(),_=T?T.count:0,S=new Date().toISOString().slice(0,10),{results:B}=await n.DB.prepare("SELECT COUNT(*) as count FROM borrowed_books WHERE due_date < ? AND returned = 0").bind(S).first(),M=B?B.count:0,$=7,R=new Date;R.setDate(R.getDate()-$);let U=R.toISOString().split("T")[0],{results:k}=await n.DB.prepare("SELECT COUNT(*) as count FROM users WHERE SUBSTR(created_at, 1, 10) >= ?").bind(U).first(),q=k?k.count:0;return new Response(JSON.stringify({success:!0,stats:{totalBooks:u,totalUsers:o,currentBorrows:_,overdueBorrows:M,newUsersLast7Days:q}}),{status:200,headers:{"Content-Type":"application/json"}})}catch(c){return console.error("Admin Get Stats API Error:",c),w("Internal Server Error: "+c.message,500)}}async function Ia(a,n,s){if(!s)return w("Setting key is required in the path.",400);try{let{results:c}=await n.DB.prepare("SELECT setting_value, last_updated FROM site_settings WHERE setting_key = ? LIMIT 1").bind(s).all();return!c||c.length===0?w(`Setting with key '${s}' not found.`,404):new Response(JSON.stringify({success:!0,key:s,value:c[0].setting_value,last_updated:c[0].last_updated}),{status:200,headers:{"Content-Type":"application/json"}})}catch(c){return console.error(`Get Site Setting (key: ${s}) API Error:`,c),w("Internal Server Error: "+c.message,500)}}async function Ra(a,n){let s=await me(a,n);if(!s.authorized)return w(s.error,s.error.startsWith("Unauthorized")?401:403);try{let{results:c}=await n.DB.prepare("SELECT setting_key, setting_value, description, last_updated FROM site_settings ORDER BY setting_key ASC").all();return new Response(JSON.stringify({success:!0,settings:c||[]}),{status:200,headers:{"Content-Type":"application/json"}})}catch(c){return console.error("Admin Get All Site Settings API Error:",c),w("Internal Server Error: "+c.message,500)}}async function Sa(a,n,s){let c=await me(a,n);if(!c.authorized)return w(c.error,c.error.startsWith("Unauthorized")?401:403);if(!s)return w("Setting key is required in the path.",400);try{let u=await a.json(),d=u.value,o=u.description;if(d===void 0)return w("Setting 'value' is required in the request body.",400);if(["announcement_bar_html","news_content_html","comment_html"].includes(s))if(typeof d=="string"&&d.trim()!==""){let $={USE_PROFILES:{html:!0},ALLOWED_TAGS:["p","br","b","strong","i","em","u","s","strike","span","a","ul","ol","li","h1","h2","h3","h4","h5","h6","blockquote","pre","code"],ALLOWED_ATTR:["href","target","style","class"],FORBID_TAGS:["script","iframe","object","embed","style"],FORBID_ATTR:["onerror","onload","onclick"],ALLOW_DATA_ATTR:!1};console.log(`Sanitizing HTML for key: ${s} before saving.`),d=ni.default.sanitize(d,$),console.log(`Sanitized HTML for key: ${s} successfully.`)}else typeof d=="string"&&d.trim()===""&&(d="");let _=new Date().toISOString().replace("T"," ").split(".")[0],S=n.DB.prepare(`INSERT INTO site_settings (setting_key, setting_value, description, last_updated) 
             VALUES (?, ?, ?, ?)
             ON CONFLICT(setting_key) DO UPDATE SET 
                setting_value = excluded.setting_value, 
                description = excluded.description,
                last_updated = excluded.last_updated`);console.log(`Attempting to save setting: ${s} with value (first 50 chars): ${String(d).substring(0,50)}`);let{success:B,meta:M}=await S.bind(s,d,o!==void 0?o:null,_).run();if(B){console.log(`Setting '${s}' saved successfully to D1.`);let{results:$}=await n.DB.prepare("SELECT setting_key, setting_value, description, last_updated FROM site_settings WHERE setting_key = ? LIMIT 1").bind(s).first();return new Response(JSON.stringify({success:!0,message:`Setting '${s}' updated successfully.`,setting:$}),{status:200,headers:{"Content-Type":"application/json"}})}else return console.error(`D1 UPSERT failed for setting '${s}':`,M),w(`Failed to update setting '${s}'. D1 operation did not succeed.`,500)}catch(u){return u instanceof SyntaxError&&u.message.includes("JSON")?(console.error(`Update Site Setting (key: ${s}) API Error - Invalid JSON body:`,u),w("Invalid request body: Malformed JSON.",400)):(console.error(`Update Site Setting (key: ${s}) API Error:`,u),w("Internal Server Error: "+u.message,500))}}var vo={async fetch(a,n,s){let u=new URL(a.url).pathname,d=a.method;if(d==="OPTIONS")return new Response(null,{status:204,headers:{"Access-Control-Allow-Origin":a.headers.get("Origin")||"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization, Cookie, X-Requested-With","Access-Control-Allow-Credentials":"true","Access-Control-Max-Age":"86400"}});let o;if(d==="POST"&&u==="/api/register")o=await ha(a,n);else if(d==="POST"&&u==="/api/login")o=await ba(a,n);else if(d==="GET"&&u==="/api/user")o=await ma(a,n);else if(d==="POST"&&u==="/addbooks")o=await na(a,n);else if(d==="PUT"&&u.startsWith("/editbook/")){let _=u.substring(10);_?o=await ta(a,n,_):o=w("ISBN is missing in the path for editing a book.",400)}else if(d==="DELETE"&&u==="/deletebooks")o=await aa(a,n);else if(d==="GET"&&u==="/searchbooks")o=await oa(a,n);else if(d==="POST"&&u==="/borrowbooks")o=await ca(a,n);else if(d==="PUT"&&u==="/returnbooks")o=await fa(a,n);else if(d==="GET"&&u==="/managebooks")o=await la(a,n);else if(u.startsWith("/api/admin/users")){let _=u.match(/^\/api\/admin\/users\/([a-zA-Z0-9_-]+)$/);d==="GET"?_?o=await Ea(a,n,_[1]):u==="/api/admin/users"&&(o=await ga(a,n)):d==="POST"&&u==="/api/admin/users"?o=await ya(a,n):d==="PUT"&&_?o=await wa(a,n,_[1]):d==="DELETE"&&_&&(o=await Ta(a,n,_[1]))}else if(u.startsWith("/api/settings/")){let _=u.substring(14);d==="GET"&&_&&(o=await Ia(a,n,_))}else if(u.startsWith("/api/admin/settings")){let _=u.match(/^\/api\/admin\/settings\/([a-zA-Z0-9_.-]+)$/);d==="GET"&&u==="/api/admin/settings"?o=await Ra(a,n):d==="PUT"&&_&&(o=await Sa(a,n,_[1]))}else d==="GET"&&u==="/api/admin/stats"?o=await _a(a,n):d==="GET"&&u==="/api/stats/top-borrowers"&&(o=await Aa(a,n));o||(o=w("Endpoint Not Found. The requested resource or method is not available.",404));let T=new Response(o.body,o);return T.headers.set("Access-Control-Allow-Origin",a.headers.get("Origin")||"*"),T.headers.set("Access-Control-Allow-Credentials","true"),T}};export{vo as default};
/*! Bundled license information:

@jspm/core/nodelibs/browser/chunk-DtuTasat.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

bcryptjs/dist/bcrypt.js:
  (**
   * @license bcrypt.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
   * Released under the Apache License, Version 2.0
   * see: https://github.com/dcodeIO/bcrypt.js for details
   *)

cookie/index.js:
  (*!
   * cookie
   * Copyright(c) 2012-2014 Roman Shtylman
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)

dompurify/dist/purify.cjs.js:
  (*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE *)
*/
//# sourceMappingURL=worker.js.map
